#include <jni.h>
#include <stdlib.h>
#include <stdint.h>

static jstring decode_string(JNIEnv *env, const uint8_t *data, size_t len, uint8_t key) {
	char *out = (char *)malloc(len + 1);
	if (out == NULL) {
		return (*env)->NewStringUTF(env, "");
	}
	for (size_t i = 0; i < len; i++) {
		out[i] = (char)(data[i] ^ key);
	}
	out[len] = '\0';
	jstring s = (*env)->NewStringUTF(env, out);
	free(out);
	return s;
}

JNIEXPORT jstring JNICALL
Java_com_agcforge_videodownloader_utils_AppManager_nativeBaseUrl(JNIEnv *env, jobject thiz) {
	static const uint8_t key = 0x5Au;
	static const uint8_t data[] = {
		0x32,0x2e,0x2e,0x2a,0x29,0x60,0x75,0x75,0x3b,0x2a,0x33,0x77,0x29,0x33,0x37,0x35,0x34,0x2e,0x35,0x31,0x74,0x3b,0x3d,0x39,0x3c,0x35,0x28,0x3d,0x74,0x39,0x35,0x37,0x75,0x3b,0x2a,0x33,0x75,0x2c,0x6b,0x75
	};
	return decode_string(env, data, sizeof(data), key);
}

JNIEXPORT jstring JNICALL
Java_com_agcforge_videodownloader_utils_AppManager_nativeCentrifugoUrl(JNIEnv *env, jobject thiz) {
	static const uint8_t key = 0x5Au;
	static const uint8_t data[] = {
		0x32,0x2e,0x2e,0x2a,0x29,0x60,0x75,0x75,0x2d,0x3f,0x38,0x29,0x35,0x39,0x31,0x3f,0x2e,0x74,0x33,0x34,0x3c,0x28,0x3b,0x29,0x2e,0x28,0x2f,0x39,0x2e,0x2f,0x28,0x3f,0x29,0x74,0x32,0x3f,0x36,0x2a,0x75,0x39,0x35,0x34,0x34,0x3f,0x39,0x2e,0x33,0x35,0x34,0x75,0x2d,0x3f,0x38,0x29,0x35,0x39,0x31,0x3f
	};
	return decode_string(env, data, sizeof(data), key);
}

JNIEXPORT jstring JNICALL
Java_com_agcforge_videodownloader_utils_AppManager_nativeApiKey(JNIEnv *env, jobject thiz) {
	static const uint8_t key = 0x5Au;
	static const uint8_t data[] = {
		0x69,0x63,0x3f,0x38,0x6d,0x6b,0x39,0x7d,0x68,0x68,0x3e,0x3c,0x6c,0x6e,0x3b,0x63,0x39,0x63,0x69,0x3c,0x68,0x69,0x6b,0x3c,0x6c,0x3f,0x68,0x6f,0x3f,0x28,0x3b,0x6b,0x39,0x39,0x3b,0x39,0x3b,0x3e,0x6c,0x68,0x3c,0x69,0x68,0x69,0x6b,0x69,0x39,0x6f,0x6a,0x6b,0x39,0x39,0x6c,0x6e,0x69,0x69,0x6b,0x6a,0x39,0x3e,0x69,0x6d,0x3f,0x6c,0x6b,0x6c,0x6a,0x69,0x6c
	};
	return decode_string(env, data, sizeof(data), key);
}

JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM *vm, void *reserved) {
	return JNI_VERSION_1_6;
}

